-- Create USERS table
CREATE TABLE USERS (
    USER_ID INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
    USERNAME VARCHAR(50) NOT NULL UNIQUE,
    PASSWORD VARCHAR(50) NOT NULL,
    EMAIL VARCHAR(100),
    BALANCE DECIMAL(10, 2) DEFAULT 0.00
);

-- Create PRODUCTS table
CREATE TABLE PRODUCTS (
    PRODUCT_ID INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
    NAME VARCHAR(100) NOT NULL,
    DESCRIPTION VARCHAR(255),
    PRICE DECIMAL(10, 2) NOT NULL,
    STOCK_QUANTITY INT DEFAULT 0,
    TYPE VARCHAR(20) NOT NULL, -- 'PHYSICAL' or 'DIGITAL'
    WEIGHT DOUBLE, -- Only for Physical
    DOWNLOAD_LINK VARCHAR(255) -- Only for Digital
);

-- Create ORDERS table
CREATE TABLE ORDERS (
    ORDER_ID INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
    USER_ID INT,
    TOTAL_AMOUNT DECIMAL(10, 2),
    STATUS VARCHAR(20), -- 'PENDING', 'PAID', 'SHIPPED'
    ORDER_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID)
);

-- Create ORDER_ITEMS table
CREATE TABLE ORDER_ITEMS (
    ITEM_ID INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
    ORDER_ID INT,
    PRODUCT_ID INT,
    QUANTITY INT,
    PRICE_AT_PURCHASE DECIMAL(10, 2),
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID),
    FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS(PRODUCT_ID)
);

-- Seed Data: Users
INSERT INTO USERS (USERNAME, PASSWORD, EMAIL, BALANCE) VALUES ('admin', 'admin123', 'admin@store.com', 1000.00);
INSERT INTO USERS (USERNAME, PASSWORD, EMAIL, BALANCE) VALUES ('user', 'user123', 'user@store.com', 50.00);

-- Seed Data: Physical Products
INSERT INTO PRODUCTS (NAME, DESCRIPTION, PRICE, STOCK_QUANTITY, TYPE, WEIGHT) 
VALUES ('Java Programming Book', 'Comprehensive guide to Java 21', 59.99, 10, 'PHYSICAL', 1.5);

INSERT INTO PRODUCTS (NAME, DESCRIPTION, PRICE, STOCK_QUANTITY, TYPE, WEIGHT) 
VALUES ('Mechanical Keyboard', 'Clicky keys for coding', 120.50, 5, 'PHYSICAL', 0.8);

-- Seed Data: Digital Products
INSERT INTO PRODUCTS (NAME, DESCRIPTION, PRICE, STOCK_QUANTITY, TYPE, DOWNLOAD_LINK) 
VALUES ('IntelliJ IDEA License', '1-year subscription', 149.00, 999, 'DIGITAL', 'https://jetbrains.com/download');

INSERT INTO PRODUCTS (NAME, DESCRIPTION, PRICE, STOCK_QUANTITY, TYPE, DOWNLOAD_LINK) 
VALUES ('Design Patterns E-Book', 'PDF version of GoF book', 29.99, 999, 'DIGITAL', 'https://ebooks.com/gof.pdf');
